 eReader Prestigio: единство и борьба противоположностей одной читалки
Электронные книги, История ИТ*, Изучение языков, IT-Биографии*, Блог компании Prestigio

Огромный привет читателям и пользователям GeekTimes, которые заглянули к нам в блог!

Любители ли Вы читать книги?! Более, чем уверен, что среди нас много любителей почитать в транспорте, или перед сном, или на курорте под палящими лучами южного солнца. Кто-то предпочитает подержать в руках книгу в твёрдом красивом переплёте и потеребить плотненькие странички. Но всё больше и больше людей переходят на чтение электронных книг, из-за удобства и простоты использования. Кто-то любит художественную литературу, кто-то предпочитает исключительно профессиональную, но перед каждым из нас встаёт один и тот же вопрос: на чём удобнее и комфортнее читать любимые книги?!

Сегодня, как и обещали в первой статье, мы начинаем цикл публикаций о продуктах Prestigio с истории создания и развития одного из программных продуктов Prestigio – eReader Prestigio. Это приложение изначально разрабатывалось в качестве домашней библиотеки, но за пару лет разрослось до популярной Android-читалки электронных книг с поддержкой множества удобных функции и всех популярных форматов как электронных, так и аудио-книг. Под катом мы обсудим некоторые проблемы, с которыми нам пришлось столкнуться при разработке приложения, а также пути их решения, затронем аспекты взаимодействия с официальными властями и лицами для получения легального доступа к литературным произведениям и размещения в библиотеке.

Но обо всём по порядку.

Предыстория

В 2012 года в недрах Prestigio вызрела идея запуска своей линейки планшетов, которая в последующем должна была стать основой управления эко-системой «умного дома» Prestigio. Чтобы начать работать в данном направлении – проще говоря, чтобы опробовать свои силы – было предложено отработать модель разработки при создании портативной и интерактивной библиотеки или хотя бы «книжной полки».

К тому же, основатель компании, белорус по национальности, жаждал увидеть произведения национальных авторов на белорусском языке, доступные каждому желающему в любой точке земного шара, в том числе и произведения из списка школьной программы. Но об этом мы расскажем в специальном интервью с основателем Prestigio. Пока же отметим, что для этих целей был закуплен на собственные средства аппарат для автоматической отцифровки книг, а также заключены договоры с издателями и правообладателями. В результате наши пользователи, говорящие и/или изучающие белорусский язык имеют полный и, главное, бесплатный (!!!) доступ к более 3000 (!!!) произведений литературы в формате EPUB!


В магазине Вы можете приобрести и прочитать более 50 000 книг на более 25 языках мира. Естественно, что часть из них распространяется совершенно бесплатно


Большинство книг, конечно же, на русском, но и другие языки не отстают по мере развития магазина

Итак, есть желание, есть возможности, и практически нет конкурентов: тогда 3-4 года назад чтение электронных книг с различных устройств только входило в моду, к тому же, в основном читали на специальных девайсах с E-ink дисплеем. Что же касается приложений для обычных смартфонов, то особого выбора и разнообразия программ для чтения тогда ещё не существовало, в частности для планшетов. Рынку только-только предстояло бурное развитие с выпуском дешёвых 100-долларовых планшетов.

В мире Android-устройств в то время безраздельно правил Имбирный Хлебушек aka Gingerbread (2.3), и эта версия была исключительно для смартфонов, а для планшетов предусматривалсь свой Honeycomb. А версии великого объединения Android 4.х, появившейся в 2011 году, ещё предстояло завоевать своих пользователей.


История появления различных версий Android (Источник)

Как создавалась читалка: извилистый путь наверх

Первые шаги: аутсорс разработка или когда всё идёт не по плану

К сожалению, большой проблемой оказалось отсутствия опыта, как в части дизайна интерфейса, так и программирования под Android. В воздухе витали только идеи, поэтому, чтобы переложить их в реальный продукт, в компании Prestigio решили нанять стороннюю команду разработчиков, которая позволила бы, как тогда казалось, максимально упростить процесс создания приложения, а также минимизировать затраты на разработку.

И вполне естественно, что выбор пал на команду, у которой уже был достаточный опыт – команду FB Reader. В течение полугода был разработан концепт-дизайн, нарисованы и прописаны основные блоки приложения, а также добавлена та самая "книжная полка". И к осени 2012 года на свет появился eReader Prestigio версии 1.0, который изначально был доступен только для планшетов Prestigio (в качестве предустановленной версии), ведь разрабатывалась читалка в качестве встроенной библиотеки.


В чём-то eReader Prestigio и FB Reader были как две капли воды похожи


Но были и характерные отличия в дизайне и функциональности: например, у FB Reader отсутствует "книжная полка" как таковая, изменён файловый менеджер

К сожалению, к концу 2012 года из-за высокой стоимости разработки для такого локального продукта, контакты с командой FB Reader были разорваны, а написанный к тому времени код был реквизирован. Вторая попытка отдать проект на аутсор в равной мере обернулась фиаско, хотя и была выпущена вторая версия приложения с добавлением нового функционала и опций, но подробнее об этом чуть ниже. В конечном итоге пришлось искать внутренние возможности для продолжения работ над приложением.



Дорогой урок: аутсорс разработка, кончено, имеет свои достоинства (например, если требуется создать приложение и забыть про него в плане поддержки и обновлений), но и не лишена существенных недостатков. Недостаточная мотивация самого аутсорс разработчика или группы разработчиков, работающих за фиксированную, зачастую почасовую оплату, и затягивание сроков сдачи проекта. Заказчику необходимо проработать проект, отдаваемый на аутсорс, до мельчайших деталей, ибо игра в «пинг-понг» может обойтись и наверняка обойдётся слишком дорого.

DRM и Adobe: без DRM никак, а с DRMом тяжко

Следующей вехой и большим шагом вперёд стало подключение DRM (Digital Rights Management) книг с помощью RMSDK от Adobe в версии приложения 2.0, а также создание полноценного магазина и личного кабинета или, скажем так, «читательского билета» для синхронизации между устройствами. К этому времени парадигма разработки приложения начала меняться: на смену сугубо локальному продукту приходит доступная для всех версия через Google Play.

Читатель, естественно, задастся вопросом: а зачем вообще добавлять DRM-книги и поддержку DRM-форматов?
Ответ очень прост: главная цель создания данного приложения заключалась в том, чтобы иметь портативную библиотеку, доступной в любой точки заменого шара, на любых языках с возможностью покупки любых книг при желании. И тут встаёт дилемма: либо пиратские версии книг, либо полноценный и легальный DRM-контент. К сожалению, пиратство, мягко говоря, не поощряется в большинстве страны, особенно, так называемого, цивилизованного мира, именно поэтому без легализации контента никак не обойтись. И это же является одной из основных причин, почему мы не может подключить каталог Флибутсы напрямую через читалку.

К тому же, через обратную связь в какой-то моент стали поступать просьбы от наших пользователей из Польши, Германии, Чехии, других стран ЕС добавить те или иные любимые ими и интересные книги на их родных языках. К нашему глубокому сожалению, ситуация с законодательством на территории бывшего СССР крайне затрудняет заключение договоров и продвижение DRM-книг на русском, украинском и белорусском языках по доступным ценам, а вот в европейских странах литературные произведения только так и могут распространяться. Но об этом на более глубоком уровне, как уже отмечалось выше, мы поговорим в другой раз.

И хотя в коде были уже внедрены такие фичи, как OPDS (Open Publication Distribution System)-каталог, основа для магазина и личный кабинет, всё это необходимо было развивать, улучшать и просто поддерживать в работоспособном состоянии. Полностью разочаровавшись в аутсорсе, пришлось собрать собственную команду разработчиков, и начать, фактически, строить всё заново на заготовленном фундаменте.

К существующим проблемам добавилась ещё одна. Примерно в середине 2014 года вышло обновление RMSDK с новыми библиотеками от Adobe, которое обладало рядом существенных недостатков:

    библиотека отъедала половину скачиваемого объёма приложения, соответственно, для нормальной работы пришлось её очень сильно порезать перед компиляцией и добавлением в приложение;
    библиотека работает не с самим текстом, а преобразует его в картинки-страницы, которые не могут быть скормленны синтезатору речи (text-to-speech);
    библиотека нативная и требует компиляции под разные версии ОС и устройств исключительно на MAC, что создавало ряд трудностей.


Рабочие моменты: медленный EPUB

Кстати, команда FB Reader пошла иным путём, предлагая скачивать и устанавливать дополнения — плагины — к основной версии программы, что по своему затрудняет работу с ним.

Великое объединение Android и FullHD-экраны

Следующим важным этапом стал редизайн графической оболочки и проблемы, которое принесло с собой объединение планшетной и смартфонной версий Android в единый Android 4, а также выпуск устройств с полноценным FullHD-дисплеем.

Примерно полгода занял процесс редизайна графической оболочки приложения, одновременно с которой осуществлялся переход на новое меню Android 4: вместо четырёх нижних кнопок, осталось только 3, к тому же изменилась верхняя область уведомлений. Плюс ко всему, с 2012 по 2014 год шло активное внедрение FullHD дисплеев на смартфонах, то есть дисплеев с разрешением 1920 на 1080 пикселей. Если не изменяет память, то одной из первых ласточек был Butterfly от компании HTC. При этом оказалось, что программная реализация различных эффектов, например, эффекта перелистывания сильно подтормаживает на многих устройствах из-за программного ускорения графики, что привело к внедрению уже аппаратного ускорения, реализованного на OpenGL. Фактически приложение родилось заново в версии 3.0.


Существенное различие: программное перелистывание с настройкой «принудительное ускорение графики» (слева) и реализованное на openGL (справа) для FullHD дисплея

Конечно же, не обошлось без эксцессов. Так некоторые фирмы-производители устройств (не будем показывать пальцем), заявляли поддержку OpenGL2, хотя на самом деле чипсеты не имели такой поддержки, что приводило просто к пустым страницам во время чтения. Тогда как другие производители неверно рассчитывали и указывали в прошивках разрешение экрана, которое автоматически считывается при отрисовке интерфейса, что так же сказывалось на отображаемой картинке:


Смешные баги, из-за неверных данных, заложенных производителем в прошивку

Рабочие моменты: желания пользователей – благо или вред?!


Новые процессоры от Intel на базе x86 архитектуры: кошмары разработчиков

Год 2014 ознаменовался релизом новых процессоров от компании Intel на базе архитектуры x86, которые очень быстро начали захватывать рынок, хотя «прототипы» устройств были доступны ещё с 2012 года. Мало кто тогда думал, что это потребует нечеловеческих усилий от разработчиков, ведь смена архитектуры без соответствующих средств переноса с платформы на платформу фактически означает написание нового приложения под новую архитектуру.

Компания Intel даже проводила мастер-классы, призывая активно разрабатывать под платформу x86 (и даже на Хабре). Однако вскоре после успешного запуска и некоторого шокового состояния, гиганты Google и Intel договорились и выпустили специальный компилятор для кросс-архитектурного создания приложений (обзор в блоге Intel).

Вместо заключения: Планы на будущее

Сегодня читалка eReader Prestigio – это более восьми миллионов пользователей на 9000(!!!) различных Android-устройствах, поддержка более 25 языковых пакетов, более 50 000 книг на этих языках, частью из которых можно наслаждаться абсолютно бесплатно в одном из десятка наиболее распространённых книжных форматов (FB2, DOC, RTF, TXT, DJVU, HTML, MOBI, EPUB и EPUB2, PDF), а также аудиофайлов MP3 и AAC. Плюс ко всему, можно установить словарь ColorDict напрямую из приложения и мгновенно переводить незнакомые слова в иностранной литературе, что существенно облегчает чтение неадаптированных текстов. При этом ридер выполнен в эргономичном стиле Material Design и имеет интуитивно понятный для пользователя интерфейс.


Читалка в обновлённом стиле Material Design


Все поддерживаемые форматы в одном месте, включая и аудиокниги


Сравнение eReader с другими читалками (Источник)

Однако команда eReader Prestigio не сидит без дела. Буквально пару месяцев назад прошёл Helloween и только-только завершились новогодние праздники, которые наша читалка встретила с обновлённой праздничной стилизацией.


Так мы отметили Хэллоуин


А такие обои были преподнесены к новогодним праздникам

В ближайшее время мы добавим поддержку формата DOCX в качестве плагина (опять-таки процесс тормозиться из-за большого размера библиотеки), а ещё в планах PDF-парсер. А вот с новыми форматами HTML5 и EPUB3, к сожалению, пока придётся повременить, из-за того, что форматы ещё не пришли к какому-то единому знаменателю и постоянно дополняются, корректируются и изменяются.

Система синтезатора речи (text-to-speech или TTS) уже встроена в читалку и ей, как не парадоксально бы это звучало, ловко пользуются люди с проблемами зрения. На данный момент, это встроенный TTS от Google, который, может быть, и хорошо справляется с английскими текстами, но плохо работает с другими языками. В скором времени будет реализована поддержка сторонних синтезаторов речи в виде подгружаемых плагинов, которые позволят нашим пользователям самим выбирать наиболее комфортный для них TTS.

Работы по расширению библиотеки и охвату всё новых произведений литературы идут постоянно. Однако мы не в состоянии предугадать все чаяния и желания пользователей, поэтому мы запустим в скором времени специальный сервис, с помощью которого Вы, уважаемые книголюбы, сможете запросить определённую книгу, которой ещё нет в библиотеке, а мы по мере сил и возможностей будем стараться их туда добавлять.

И чуть не забыли: скоро мы объявим конкурс на интересные тематические обои для читалки с ценными призами от компании Prestigio, так что не забывайте подписываться на наш блог и следить за нашими новостями и обновлениями.
Вам не сложно, а нам приятно!